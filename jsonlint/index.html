<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JSON Playground üéÆ</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", system-ui, sans-serif;
        background: linear-gradient(
          135deg,
          #1a1a2e 0%,
          #16213e 50%,
          #0f3460 100%
        );
        min-height: 100vh;
        color: #e8e8e8;
        overflow-x: hidden;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
      }

      header {
        text-align: center;
        padding: 30px 0;
        position: relative;
      }

      h1 {
        font-size: 3rem;
        background: linear-gradient(90deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3);
        background-size: 300% 300%;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        animation: gradient-shift 3s ease infinite;
        text-shadow: 0 0 30px rgba(255, 107, 107, 0.3);
      }

      @keyframes gradient-shift {
        0%,
        100% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
      }

      .subtitle {
        color: #888;
        margin-top: 10px;
        font-size: 1.1rem;
      }

      .status-bar {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .status-badge {
        padding: 10px 20px;
        border-radius: 50px;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
        background: rgba(255, 255, 255, 0.1);
        border: 2px solid transparent;
      }

      .status-badge.valid {
        background: rgba(46, 213, 115, 0.2);
        border-color: #2ed573;
        color: #2ed573;
      }

      .status-badge.invalid {
        background: rgba(255, 71, 87, 0.2);
        border-color: #ff4757;
        color: #ff4757;
        animation: shake 0.5s ease;
      }

      .status-badge.waiting {
        background: rgba(255, 206, 86, 0.2);
        border-color: #feca57;
        color: #feca57;
      }

      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        20%,
        60% {
          transform: translateX(-5px);
        }
        40%,
        80% {
          transform: translateX(5px);
        }
      }

      .stats {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
      }

      .stat {
        background: rgba(255, 255, 255, 0.05);
        padding: 8px 15px;
        border-radius: 20px;
        font-size: 0.9rem;
      }

      .stat span {
        color: #48dbfb;
        font-weight: bold;
      }

      .main-area {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-top: 20px;
      }

      @media (max-width: 900px) {
        .main-area {
          grid-template-columns: 1fr;
        }
      }

      .panel {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 20px;
        overflow: hidden;
        border: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        transition: all 0.3s ease;
      }

      .panel:hover {
        border-color: rgba(255, 255, 255, 0.2);
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
      }

      .panel-header {
        background: rgba(255, 255, 255, 0.05);
        padding: 15px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .panel-title {
        font-size: 1.1rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .panel-title .icon {
        font-size: 1.3rem;
      }

      .btn-group {
        display: flex;
        gap: 8px;
      }

      button {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        color: white;
        padding: 8px 16px;
        border-radius: 10px;
        cursor: pointer;
        font-size: 0.9rem;
        font-weight: 500;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      }

      button:active {
        transform: translateY(0);
      }

      button.secondary {
        background: rgba(255, 255, 255, 0.1);
      }

      button.secondary:hover {
        background: rgba(255, 255, 255, 0.2);
        box-shadow: 0 5px 20px rgba(255, 255, 255, 0.1);
      }

      button.success {
        background: linear-gradient(135deg, #2ed573 0%, #26de81 100%);
      }

      button.danger {
        background: linear-gradient(135deg, #ff4757 0%, #ff6b81 100%);
      }

      textarea {
        width: 100%;
        height: 500px;
        background: rgba(0, 0, 0, 0.3);
        border: none;
        color: #e8e8e8;
        font-family: "Fira Code", "Consolas", monospace;
        font-size: 14px;
        padding: 20px;
        resize: none;
        outline: none;
        line-height: 1.6;
      }

      textarea::placeholder {
        color: #666;
      }

      .output-area {
        width: 100%;
        height: 500px;
        background: rgba(0, 0, 0, 0.3);
        padding: 20px;
        overflow: auto;
        font-family: "Fira Code", "Consolas", monospace;
        font-size: 14px;
        line-height: 1.6;
      }

      .json-key {
        color: #ff9ff3;
      }
      .json-string {
        color: #2ed573;
      }
      .json-number {
        color: #48dbfb;
      }
      .json-boolean {
        color: #feca57;
      }
      .json-null {
        color: #ff6b6b;
      }
      .json-bracket {
        color: #aaa;
      }

      .error-display {
        background: rgba(255, 71, 87, 0.1);
        border: 1px solid #ff4757;
        border-radius: 10px;
        padding: 15px;
        margin: 10px 20px 20px;
        display: none;
      }

      .error-display.show {
        display: block;
        animation: fadeIn 0.3s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .error-title {
        color: #ff4757;
        font-weight: 600;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .error-message {
        color: #ff9f9f;
        font-family: "Fira Code", monospace;
        font-size: 0.9rem;
      }

      .error-line {
        margin-top: 10px;
        padding: 10px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 5px;
        font-family: "Fira Code", monospace;
        font-size: 0.85rem;
        color: #aaa;
      }

      .confetti {
        position: fixed;
        pointer-events: none;
        z-index: 1000;
      }

      .toast {
        position: fixed;
        bottom: 30px;
        right: 30px;
        padding: 15px 25px;
        border-radius: 10px;
        color: white;
        font-weight: 500;
        transform: translateX(150%);
        transition: transform 0.3s ease;
        z-index: 1000;
      }

      .toast.show {
        transform: translateX(0);
      }

      .toast.success {
        background: linear-gradient(135deg, #2ed573 0%, #26de81 100%);
      }

      .toast.error {
        background: linear-gradient(135deg, #ff4757 0%, #ff6b81 100%);
      }

      .indent-selector {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-left: 20px;
      }

      .indent-selector label {
        font-size: 0.9rem;
        color: #888;
      }

      .indent-selector select {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        cursor: pointer;
      }

      .lint-warning {
        background: rgba(255, 206, 86, 0.1);
        border-left: 3px solid #feca57;
        padding: 10px 15px;
        margin: 5px 20px;
        border-radius: 0 5px 5px 0;
        font-size: 0.9rem;
        color: #feca57;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .lint-warnings-container {
        max-height: 150px;
        overflow-y: auto;
      }

      footer {
        text-align: center;
        padding: 30px;
        color: #666;
        font-size: 0.9rem;
      }

      .keyboard-hint {
        display: inline-flex;
        align-items: center;
        gap: 5px;
        background: rgba(255, 255, 255, 0.1);
        padding: 3px 8px;
        border-radius: 5px;
        font-size: 0.8rem;
        margin-left: 10px;
      }

      kbd {
        background: rgba(255, 255, 255, 0.2);
        padding: 2px 6px;
        border-radius: 3px;
        font-family: monospace;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>üéÆ JSON Playground</h1>
        <p class="subtitle">Paste, validate, format, and celebrate! ‚ú®</p>
      </header>

      <div class="status-bar">
        <div id="statusBadge" class="status-badge waiting">
          <span class="status-icon">‚è≥</span>
          <span class="status-text">Waiting for JSON...</span>
        </div>
        <div class="stats">
          <div class="stat">Lines: <span id="lineCount">0</span></div>
          <div class="stat">Characters: <span id="charCount">0</span></div>
          <div class="stat">Keys: <span id="keyCount">0</span></div>
          <div class="stat">Depth: <span id="depthCount">0</span></div>
        </div>
      </div>

      <div class="main-area">
        <div class="panel">
          <div class="panel-header">
            <div class="panel-title">
              <span class="icon">üìù</span>
              Input
              <span class="keyboard-hint"
                ><kbd>Ctrl</kbd>+<kbd>Enter</kbd> to format</span
              >
            </div>
            <div class="btn-group">
              <button class="secondary" onclick="loadSample()">
                üì¶ Sample
              </button>
              <button class="danger" onclick="clearInput()">üóëÔ∏è Clear</button>
            </div>
          </div>
          <textarea
            id="jsonInput"
            placeholder='Paste your JSON here... üéØ

Try pasting something like:
{"name": "Claude", "type": "AI", "awesome": true}'
            spellcheck="false"
          ></textarea>
          <div id="errorDisplay" class="error-display">
            <div class="error-title">‚ùå JSON Error</div>
            <div id="errorMessage" class="error-message"></div>
            <div id="errorLine" class="error-line"></div>
          </div>
          <div id="lintWarnings" class="lint-warnings-container"></div>
        </div>

        <div class="panel">
          <div class="panel-header">
            <div class="panel-title">
              <span class="icon">‚ú®</span>
              Formatted Output
            </div>
            <div class="btn-group">
              <div class="indent-selector">
                <label>Indent:</label>
                <select id="indentSize" onchange="formatJSON()">
                  <option value="2">2 spaces</option>
                  <option value="4">4 spaces</option>
                  <option value="tab">Tab</option>
                </select>
              </div>
              <button onclick="minifyJSON()">üóúÔ∏è Minify</button>
              <button class="success" onclick="copyOutput()">üìã Copy</button>
            </div>
          </div>
          <div id="jsonOutput" class="output-area">
            <span style="color: #666"
              >Your formatted JSON will appear here... üé®</span
            >
          </div>
        </div>
      </div>

      <footer>
        Made with üíú | Keyboard shortcuts: <kbd>Ctrl</kbd>+<kbd>Enter</kbd>
        Format ‚Ä¢ <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>M</kbd> Minify ‚Ä¢
        <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>C</kbd> Copy
      </footer>
    </div>

    <div id="toast" class="toast"></div>

    <script>
      const input = document.getElementById("jsonInput");
      const output = document.getElementById("jsonOutput");
      const statusBadge = document.getElementById("statusBadge");
      const errorDisplay = document.getElementById("errorDisplay");
      const errorMessage = document.getElementById("errorMessage");
      const errorLine = document.getElementById("errorLine");
      const lintWarnings = document.getElementById("lintWarnings");
      const toast = document.getElementById("toast");

      let debounceTimer;

      // Real-time validation
      input.addEventListener("input", () => {
        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(() => {
          validateAndFormat();
        }, 300);
        updateStats();
      });

      // Keyboard shortcuts
      document.addEventListener("keydown", (e) => {
        if (e.ctrlKey && e.key === "Enter") {
          e.preventDefault();
          formatJSON();
        }
        if (e.ctrlKey && e.shiftKey && e.key === "M") {
          e.preventDefault();
          minifyJSON();
        }
        if (e.ctrlKey && e.shiftKey && e.key === "C") {
          e.preventDefault();
          copyOutput();
        }
      });

      function validateAndFormat() {
        const text = input.value.trim();

        if (!text) {
          setStatus("waiting", "‚è≥", "Waiting for JSON...");
          errorDisplay.classList.remove("show");
          lintWarnings.innerHTML = "";
          output.innerHTML =
            '<span style="color: #666;">Your formatted JSON will appear here... üé®</span>';
          return;
        }

        try {
          const parsed = JSON.parse(text);
          setStatus("valid", "‚úÖ", "Valid JSON!");
          errorDisplay.classList.remove("show");
          formatJSON();
          lintJSON(text, parsed);

          // Celebration for valid JSON!
          if (Math.random() > 0.7) {
            createConfetti();
          }
        } catch (e) {
          setStatus("invalid", "‚ùå", "Invalid JSON");
          showError(e, text);
          output.innerHTML =
            '<span style="color: #ff4757;">Fix the errors to see formatted output üîß</span>';
          lintWarnings.innerHTML = "";
        }
      }

      function setStatus(type, icon, text) {
        statusBadge.className = `status-badge ${type}`;
        statusBadge.querySelector(".status-icon").textContent = icon;
        statusBadge.querySelector(".status-text").textContent = text;
      }

      function showError(error, text) {
        errorDisplay.classList.add("show");

        const match = error.message.match(/position (\d+)/);
        let position = match ? parseInt(match[1]) : null;

        errorMessage.textContent = error.message;

        if (position !== null) {
          const lines = text.substring(0, position).split("\n");
          const lineNum = lines.length;
          const colNum = lines[lines.length - 1].length + 1;

          const allLines = text.split("\n");
          const problemLine = allLines[lineNum - 1] || "";

          errorLine.innerHTML = `Line ${lineNum}, Column ${colNum}:<br><code>${escapeHtml(
            problemLine
          )}</code>`;
        } else {
          errorLine.textContent = "";
        }
      }

      function formatJSON() {
        const text = input.value.trim();
        if (!text) return;

        try {
          const parsed = JSON.parse(text);
          const indentSelect = document.getElementById("indentSize");
          const indent =
            indentSelect.value === "tab" ? "\t" : parseInt(indentSelect.value);
          const formatted = JSON.stringify(parsed, null, indent);
          output.innerHTML = syntaxHighlight(formatted);
        } catch (e) {
          // Already handled in validateAndFormat
        }
      }

      function minifyJSON() {
        const text = input.value.trim();
        if (!text) return;

        try {
          const parsed = JSON.parse(text);
          const minified = JSON.stringify(parsed);
          output.innerHTML = syntaxHighlight(minified);
          showToast("Minified! üóúÔ∏è", "success");
        } catch (e) {
          showToast("Cannot minify invalid JSON", "error");
        }
      }

      function syntaxHighlight(json) {
        json = escapeHtml(json);
        return json.replace(
          /("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,
          (match) => {
            let cls = "json-number";
            if (/^"/.test(match)) {
              if (/:$/.test(match)) {
                cls = "json-key";
              } else {
                cls = "json-string";
              }
            } else if (/true|false/.test(match)) {
              cls = "json-boolean";
            } else if (/null/.test(match)) {
              cls = "json-null";
            }
            return `<span class="${cls}">${match}</span>`;
          }
        );
      }

      function escapeHtml(text) {
        const div = document.createElement("div");
        div.textContent = text;
        return div.innerHTML;
      }

      function lintJSON(text, parsed) {
        const warnings = [];

        // Check for duplicate keys (basic check)
        const keyPattern = /"([^"]+)":/g;
        const keys = {};
        let match;
        while ((match = keyPattern.exec(text)) !== null) {
          const key = match[1];
          if (keys[key]) {
            warnings.push(`‚ö†Ô∏è Duplicate key found: "${key}"`);
          }
          keys[key] = true;
        }

        // Check for trailing commas (won't parse but good to note)
        if (/,\s*[}\]]/.test(text)) {
          warnings.push("‚ö†Ô∏è Possible trailing comma detected");
        }

        // Check for very deep nesting
        const depth = getMaxDepth(parsed);
        if (depth > 10) {
          warnings.push(
            `‚ö†Ô∏è Very deep nesting (${depth} levels) - consider flattening`
          );
        }

        // Check for very long strings
        checkLongStrings(parsed, warnings);

        // Check for empty objects/arrays
        checkEmptyStructures(parsed, warnings);

        // Display warnings
        if (warnings.length > 0) {
          lintWarnings.innerHTML = warnings
            .map((w) => `<div class="lint-warning">${w}</div>`)
            .join("");
        } else {
          lintWarnings.innerHTML =
            '<div class="lint-warning" style="border-color: #2ed573; color: #2ed573;">‚ú® No lint warnings - looking good!</div>';
        }
      }

      function getMaxDepth(obj, currentDepth = 0) {
        if (typeof obj !== "object" || obj === null) {
          return currentDepth;
        }

        let maxDepth = currentDepth;
        for (const key in obj) {
          const depth = getMaxDepth(obj[key], currentDepth + 1);
          maxDepth = Math.max(maxDepth, depth);
        }
        return maxDepth;
      }

      function checkLongStrings(obj, warnings, path = "") {
        if (typeof obj === "string" && obj.length > 1000) {
          warnings.push(
            `‚ö†Ô∏è Very long string (${obj.length} chars) at ${path || "root"}`
          );
        } else if (typeof obj === "object" && obj !== null) {
          for (const key in obj) {
            checkLongStrings(obj[key], warnings, path ? `${path}.${key}` : key);
          }
        }
      }

      function checkEmptyStructures(obj, warnings, path = "") {
        if (Array.isArray(obj) && obj.length === 0) {
          warnings.push(`üí° Empty array at ${path || "root"}`);
        } else if (
          typeof obj === "object" &&
          obj !== null &&
          Object.keys(obj).length === 0
        ) {
          warnings.push(`üí° Empty object at ${path || "root"}`);
        } else if (typeof obj === "object" && obj !== null) {
          for (const key in obj) {
            checkEmptyStructures(
              obj[key],
              warnings,
              path ? `${path}.${key}` : key
            );
          }
        }
      }

      function countKeys(obj) {
        let count = 0;
        if (typeof obj === "object" && obj !== null) {
          for (const key in obj) {
            count++;
            count += countKeys(obj[key]);
          }
        }
        return count;
      }

      function updateStats() {
        const text = input.value;
        document.getElementById("lineCount").textContent = text
          ? text.split("\n").length
          : 0;
        document.getElementById("charCount").textContent = text.length;

        try {
          const parsed = JSON.parse(text);
          document.getElementById("keyCount").textContent = countKeys(parsed);
          document.getElementById("depthCount").textContent =
            getMaxDepth(parsed);
        } catch (e) {
          document.getElementById("keyCount").textContent = "-";
          document.getElementById("depthCount").textContent = "-";
        }
      }

      function copyOutput() {
        const text = input.value.trim();
        if (!text) {
          showToast("Nothing to copy!", "error");
          return;
        }

        try {
          const parsed = JSON.parse(text);
          const indentSelect = document.getElementById("indentSize");
          const indent =
            indentSelect.value === "tab" ? "\t" : parseInt(indentSelect.value);
          const formatted = JSON.stringify(parsed, null, indent);

          navigator.clipboard.writeText(formatted).then(() => {
            showToast("Copied to clipboard! üìã", "success");
            createConfetti();
          });
        } catch (e) {
          showToast("Cannot copy invalid JSON", "error");
        }
      }

      function clearInput() {
        input.value = "";
        validateAndFormat();
        updateStats();
        showToast("Cleared! üßπ", "success");
      }

      function loadSample() {
        const samples = [
          {
            name: "JSON Playground",
            version: "1.0.0",
            features: ["validate", "format", "lint", "minify"],
            settings: {
              theme: "dark",
              indentation: 2,
              autoFormat: true,
            },
            author: {
              name: "Claude",
              type: "AI Assistant",
              likes: ["helping", "coding", "JSON"],
            },
            stats: {
              users: 42000,
              rating: 4.9,
              isAwesome: true,
            },
          },
          {
            menu: {
              breakfast: [
                { item: "Pancakes", price: 8.99, popular: true },
                { item: "Eggs Benedict", price: 12.5, popular: false },
                { item: "Avocado Toast", price: 9.99, popular: true },
              ],
              drinks: ["Coffee", "Tea", "Orange Juice"],
            },
            restaurant: "The JSON Caf√©",
            rating: 4.5,
            openNow: true,
          },
          {
            game: {
              title: "JSON Quest",
              players: [
                { name: "Hero", level: 42, class: "Developer" },
                { name: "Sidekick", level: 38, class: "Tester" },
              ],
              inventory: {
                weapons: ["Keyboard of Power", "Mouse of Precision"],
                potions: 5,
                gold: 1337,
              },
            },
            highScore: 999999,
            achievements: ["First Parse", "Perfect Format", "Zero Errors"],
          },
        ];

        const sample = samples[Math.floor(Math.random() * samples.length)];
        input.value = JSON.stringify(sample);
        validateAndFormat();
        updateStats();
        showToast("Sample loaded! üì¶", "success");
      }

      function showToast(message, type) {
        toast.textContent = message;
        toast.className = `toast ${type} show`;
        setTimeout(() => {
          toast.classList.remove("show");
        }, 2000);
      }

      function createConfetti() {
        const colors = ["#ff6b6b", "#feca57", "#48dbfb", "#ff9ff3", "#2ed573"];

        for (let i = 0; i < 50; i++) {
          const confetti = document.createElement("div");
          confetti.className = "confetti";
          confetti.style.cssText = `
                    position: fixed;
                    width: ${Math.random() * 10 + 5}px;
                    height: ${Math.random() * 10 + 5}px;
                    background: ${
                      colors[Math.floor(Math.random() * colors.length)]
                    };
                    left: ${Math.random() * 100}vw;
                    top: -20px;
                    border-radius: ${Math.random() > 0.5 ? "50%" : "0"};
                    pointer-events: none;
                    z-index: 1000;
                `;
          document.body.appendChild(confetti);

          const animation = confetti.animate(
            [
              { transform: "translateY(0) rotate(0deg)", opacity: 1 },
              {
                transform: `translateY(100vh) rotate(${
                  Math.random() * 720
                }deg)`,
                opacity: 0,
              },
            ],
            {
              duration: Math.random() * 2000 + 1500,
              easing: "cubic-bezier(0.25, 0.46, 0.45, 0.94)",
            }
          );

          animation.onfinish = () => confetti.remove();
        }
      }

      // Initialize
      updateStats();
    </script>
  </body>
</html>
